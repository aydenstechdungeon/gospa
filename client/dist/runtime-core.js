import{O as d,P as r,Q as L,R as w,S as a,T as s}from"./runtime-pc9k39z0.js";import{$ as m,X as c,Y as l,Z as E,_ as i,aa as O,ba as A}from"./runtime-1av6apsb.js";import{ja as z,ka as B}from"./runtime-nmjc1qqb.js";var h={prevent:(q,Q)=>{return q.preventDefault(),Q(q)},stop:(q,Q)=>{return q.stopPropagation(),Q(q)},capture:(q,Q)=>Q(q),once:(q,Q)=>Q(q),passive:(q,Q)=>Q(q),self:(q,Q)=>{if(q.target===q.currentTarget)return Q(q)}},P=new WeakMap;function C(q,Q){return(U)=>{for(let Z of Q){if(Z==="capture"||Z==="once"||Z==="passive")continue;let $=h[Z];$(U,q)}if(Q.filter((Z)=>!["capture","once","passive"].includes(Z)).length===0)return q(U)}}function W(q){let Q=q.split(":"),U=Q[0],Y=Q.slice(1);return{event:U,modifiers:Y}}function K(q,Q,U){let{event:Y,modifiers:Z}=W(Q),$={capture:Z.includes("capture"),once:Z.includes("once"),passive:Z.includes("passive")},V=C(U,Z);if(q.addEventListener(Y,V,$),!P.has(q))P.set(q,new Map);let j=P.get(q);if(!j.has(Q))j.set(Q,new Set);return j.get(Q).add(V),()=>{q.removeEventListener(Y,V,$);let F=j.get(Q);if(F){if(F.delete(V),F.size===0)j.delete(Q)}}}function S(q){let Q=P.get(q);if(!Q)return;for(let[U,Y]of Q){let{event:Z,modifiers:$}=W(U),V={capture:$.includes("capture")};for(let j of Y)q.removeEventListener(Z,j,V)}P.delete(q)}function y(q,Q){let U=null;return(Y)=>{if(U)clearTimeout(U);U=setTimeout(()=>{q(Y),U=null},Q)}}function u(q,Q){let U=!1;return(Y)=>{if(!U)q(Y),U=!0,setTimeout(()=>{U=!1},Q)}}var f={value:(q)=>q.target.value,checked:(q)=>q.target.checked,numberValue:(q)=>Number(q.target.value),files:(q)=>q.target.files,formData:(q)=>{return q.preventDefault(),new FormData(q.target)}};function v(q,Q,U,Y){let{event:Z,modifiers:$}=W(U),V=(F)=>{if(F.target.closest(Q))C(Y,$)(F)},j={capture:$.includes("capture"),passive:$.includes("passive")};return q.addEventListener(Z,V,j),()=>{q.removeEventListener(Z,V,j)}}function g(q,Q,U){let Y=Array.isArray(q)?q:[q];return(Z)=>{if(Y.includes(Z.key)){if(U?.preventDefault)Z.preventDefault();Q(Z)}}}var p={enter:"Enter",escape:"Escape",tab:"Tab",space:" ",arrowUp:"ArrowUp",arrowDown:"ArrowDown",arrowLeft:"ArrowLeft",arrowRight:"ArrowRight"};var G=new Map,x=new A,R=!1,J={},X=null,_=null,D=null;function o(q={}){if(R){console.warn("GoSPA runtime already initialized");return}if(J=q,R=!0,J.wsUrl)X=import("./websocket-8xsz4f8h.js").then((Q)=>{return Q.initWebSocket({url:J.wsUrl,onMessage:n}).connect().catch((Y)=>{if(J.onConnectionError)J.onConnectionError(Y);else if(J.debug)console.error("WebSocket connection failed:",Y)}),Q});window.addEventListener("error",(Q)=>{if(J.debug)console.error("Runtime error:",Q.error)}),window.__GOSPA__={config:J,components:G,globalState:x,init:o,createComponent:k,destroyComponent:qq,getComponent:Qq,getState:b,setState:Uq,callAction:I,bind:H,autoInit:T}}function n(q){switch(q.type){case"init":if(q.componentId&&q.data){let Q=G.get(q.componentId);if(Q)Q.states.fromJSON(q.data)}else if(q.state){let Q=q.state;for(let[U,Y]of Object.entries(Q)){let Z=U.indexOf(".");if(Z>0){let $=U.substring(0,Z),V=U.substring(Z+1),j=G.get($);if(j)j.states.set(V,Y)}else{for(let $ of G.values())if($.states.get(U)!==void 0)$.states.set(U,Y);x.set(U,Y)}}}break;case"patch":if(q.patch){let Q=q.patch;x.fromJSON(Q)}break;case"update":if(q.componentId&&q.diff){let Q=G.get(q.componentId);if(Q)Q.states.fromJSON(q.diff)}break;case"sync":if(q.data)x.fromJSON(q.data);else if(q.key!==void 0&&q.value!==void 0){let{key:Q,componentId:U}=q;if(U){let Y=G.get(U);if(Y)Y.states.set(Q,q.value)}else x.set(Q,q.value)}break;case"error":if(J.debug)console.error("Server error:",q.error);break}}var M="gospa_local_";function t(q){try{let Q=localStorage.getItem(M+q);return Q?JSON.parse(Q):null}catch{return null}}function e(q,Q){try{localStorage.setItem(M+q,JSON.stringify(Q))}catch{}}function k(q,Q,U=!1){let Y={id:q.id,definition:q,states:new A,derived:new Map,unsubscribers:[],cleanup:[],element:Q||null,isLocal:U};if(U){let Z=t(q.id);if(Z)for(let[$,V]of Object.entries(Z))Y.states.set($,V)}for(let[Z,$]of Object.entries(q.state))if(!U||Y.states.get(Z)===void 0)Y.states.set(Z,$);if(U)for(let Z of Object.keys(q.state)){let $=Y.states.get(Z);if($){let V=O($,()=>{e(q.id,Y.states.toJSON())});Y.unsubscribers.push(V)}}if(q.computed)for(let[Z,$]of Object.entries(q.computed))Y.derived.set(Z,new E($));if(q.watch)for(let[Z,$]of Object.entries(q.watch)){let V=Y.states.get(Z);if(V)Y.unsubscribers.push(O(V,$))}if(q.mount){let Z=q.mount();if(Z)Y.cleanup.push(Z)}return G.set(q.id,Y),Y}function qq(q){let Q=G.get(q);if(!Q)return;if(Q.definition.destroy)Q.definition.destroy();for(let U of Q.cleanup)U();for(let U of Q.unsubscribers)U();for(let U of Q.derived.values())U.dispose();G.delete(q)}function Qq(q){return G.get(q)}function b(q,Q){return G.get(q)?.states.get(Q)}async function Uq(q,Q,U){let Y=G.get(q);if(!Y)return;if(Y.states.set(Q,U),!Y.isLocal&&X){let $=(await X).getWebSocketClient();if($?.isConnected)$.send({type:"update",componentId:q,payload:{key:Q,value:U}})}}function I(q,Q,...U){let Y=G.get(q);if(!Y?.definition.actions?.[Q])throw Error(`Action "${Q}" not found on component "${q}"`);return Y.definition.actions[Q](...U)}function H(q,Q,U,Y,Z){let $=b(q,Y);if(!$)return console.warn(`State "${Y}" not found on component "${q}"`),()=>{};if(Z?.twoWay)return w(Q,$);return L(Q,$,{type:U,transform:Z?.transform})}function T(){let q=document.querySelectorAll("[data-gospa-component]");for(let Q of q){let U=Q.getAttribute("data-gospa-component"),Y=Q.getAttribute("data-gospa-state"),Z=Q.hasAttribute("data-gospa-local");if(!U)continue;let $={};try{$=Y?JSON.parse(Y):{}}catch{}let V=Q.getAttribute("data-gospa-hydrate")||J.hydration?.mode||"immediate",j=()=>{k({id:U,name:U,state:$},Q,Z),Yq(Q)};if(V==="visible"){let F=new IntersectionObserver((N)=>{if(N[0].isIntersecting)F.disconnect(),j()});F.observe(Q)}else if(V==="idle"&&"requestIdleCallback"in window)window.requestIdleCallback(()=>j(),{timeout:J.hydration?.timeout||2000});else j()}}function Yq(q=document){for(let Q of q.querySelectorAll("[data-bind]")){let U=Q.closest("[data-gospa-component]")?.getAttribute("data-gospa-component")||"",Y=Q.getAttribute("data-bind"),Z=Q.getAttribute("data-transform");if(!Y)continue;let[$,V="text"]=Y.split(":").map((F)=>F.trim()),j;if(Z&&typeof window[Z]==="function")j=window[Z];H(U,Q,V,$,{transform:j})}for(let Q of q.querySelectorAll("[data-on]")){let U=Q.closest("[data-gospa-component]")?.getAttribute("data-gospa-component")||"",Y=Q.getAttribute("data-on");if(!Y)continue;let[Z,$,V]=Y.split(":").map((F)=>F.trim()),j=V?V.split(",").map((F)=>F.trim()):[];K(Q,Z,async()=>{try{I(U,$,...j)}catch{if(X){let N=(await X).getWebSocketClient();if(N?.isConnected)N.sendAction($)}}})}for(let Q of q.querySelectorAll("[data-model]")){let U=Q.closest("[data-gospa-component]")?.getAttribute("data-gospa-component")||"",Y=Q.getAttribute("data-model");if(Y)H(U,Q,"value",Y,{twoWay:!0})}}async function Jq(){if(!X)X=import("./websocket-8xsz4f8h.js");return X}async function Xq(){if(!_)_=import("./navigation-cy2qcymx.js");return _}async function Nq(){if(!D)D=import("./transition-pnw7jqct.js");return D}if(typeof document<"u"){if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",()=>{if(document.documentElement.hasAttribute("data-gospa-auto"))T()});else if(document.documentElement.hasAttribute("data-gospa-auto"))T()}export{O as watch,r as unregisterBinding,f as transformers,u as throttle,Uq as setState,s as renderList,a as renderIf,d as registerBinding,g as onKey,K as on,S as offAll,p as keys,o as init,Jq as getWebSocket,Nq as getTransitions,b as getState,Xq as getNavigation,Qq as getComponent,m as effect,qq as destroyComponent,v as delegate,y as debounce,k as createComponent,I as callAction,w as bindTwoWay,L as bindElement,H as bind,c as batch,T as autoInit,A as StateMap,l as Rune,i as Effect,E as Derived};
export{K as a,S as b,y as c,u as d,f as e,v as f,g,p as h,o as i,k as j,qq as k,Qq as l,b as m,Uq as n,I as o,H as p,T as q,Jq as r,Xq as s,Nq as t};
