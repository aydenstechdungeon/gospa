var yq=0,gq=0,P=0,E=new Set,O=null,V=[];function D(q){P++;try{q()}finally{if(P--,P===0){let Q=[...E];E.clear(),Q.forEach((Z)=>Z.notify())}}}class A{_value;_id;_subscribers=new Set;_dirty=!1;constructor(q){this._value=q,this._id=++yq}get value(){return this.trackDependency(),this._value}set value(q){if(this._equal(this._value,q))return;let Q=this._value;this._value=q,this._dirty=!0,this._notifySubscribers(Q)}get(){return this.trackDependency(),this._value}set(q){this.value=q}update(q){this.value=q(this._value)}subscribe(q){return this._subscribers.add(q),()=>this._subscribers.delete(q)}_notifySubscribers(q){if(P>0){E.add(this);return}this.notify()}notify(){let q=this._value;console.log("[GoSPA DEBUG] Rune.notify - value:",q,"subscribers count:",this._subscribers.size),this._subscribers.forEach((Q)=>Q(q,this._value))}_equal(q,Q){return Object.is(q,Q)||JSON.stringify(q)===JSON.stringify(Q)}trackDependency(){if(O)O.addDependency(this)}toJSON(){return{id:this._id,value:this._value}}}class S{_value;_compute;_dependencies=new Set;_subscribers=new Set;_dirty=!0;_disposed=!1;constructor(q){this._compute=q,this._value=void 0,this._recompute()}get value(){if(this._dirty)this._recompute();return this.trackDependency(),this._value}get(){return this.value}subscribe(q){return this._subscribers.add(q),()=>this._subscribers.delete(q)}_recompute(){let q=new Set(this._dependencies);this._dependencies.clear();let Q=O;O={addDependency:(J)=>{this._dependencies.add(J)}};try{this._value=this._compute(),this._dirty=!1}finally{O=Q}this._dependencies.forEach((J)=>{if(!q.has(J))J.subscribe(()=>{this._dirty=!0,this._notifySubscribers()})})}_notifySubscribers(){if(P>0){E.add(this);return}this.notify()}notify(){if(this._dirty)this._recompute();let q=this._value;this._subscribers.forEach((Q)=>Q(q,this._value))}trackDependency(){if(O)O.addDependency(this)}dispose(){this._disposed=!0,this._dependencies.clear(),this._subscribers.clear()}}class T{_fn;_cleanup;_dependencies=new Set;_id;_active=!0;_disposed=!1;constructor(q){this._fn=q,this._id=++gq,this._cleanup=void 0,this._run()}_run(){if(!this._active||this._disposed)return;if(this._cleanup)this._cleanup(),this._cleanup=void 0;this._dependencies.clear(),V.push(this),O=this;try{this._cleanup=this._fn()}finally{V.pop(),O=V[V.length-1]||null}}addDependency(q){this._dependencies.add(q)}notify(){this._run()}pause(){this._active=!1}resume(){this._active=!0,this._run()}dispose(){if(this._cleanup)this._cleanup();this._disposed=!0,this._dependencies.clear()}}function $q(q){return new T(q)}function k(q,Q){let Z=Array.isArray(q)?q:[q],J=[];return Z.forEach(($)=>{J.push($.subscribe((X,Y)=>{let z=Z.map((F)=>F.get()),G=Z.map((F)=>Y);Q(Array.isArray(q)?z:z[0],Array.isArray(q)?G:G[0])}))}),()=>J.forEach(($)=>$())}class x{_runes=new Map;set(q,Q){console.log("[GoSPA DEBUG] StateMap.set called - key:",q,"value:",Q);let Z=this._runes.get(q);if(Z)return console.log("[GoSPA DEBUG] StateMap.set - updating existing Rune, subscribers:",Z._subscribers?.size||0),Z.set(Q),Z;console.log("[GoSPA DEBUG] StateMap.set - creating new Rune");let J=new A(Q);return this._runes.set(q,J),J}get(q){return this._runes.get(q)}has(q){return this._runes.has(q)}delete(q){return this._runes.delete(q)}clear(){this._runes.clear()}toJSON(){let q={};return this._runes.forEach((Q,Z)=>{q[Z]=Q.get()}),q}fromJSON(q){Object.entries(q).forEach(([Q,Z])=>{if(this._runes.has(Q))this._runes.get(Q).set(Z);else this.set(Q,Z)})}}function vq(...q){if(!(typeof window<"u"&&window.__GOSPA_DEV__!==!1))return{with:()=>{}};let Z=!0,J=[],$=()=>q.map((Y)=>typeof Y==="function"?Y():Y),X=(Y)=>{let z=$();console.log(`%c[${Y}]`,"color: #888",...z),J.forEach((G)=>G(Y,z))};return new T(()=>{if($(),Z)Z=!1,X("init");else X("update")}),{with:(Y)=>{J.push(Y)}}}vq.trace=(q)=>{if(!(typeof window<"u"&&window.__GOSPA_DEV__!==!1))return;console.log(`%c[trace]${q?` ${q}`:""}`,"color: #666; font-style: italic")};var N=new Map,C=new WeakMap,fq=0;function pq(){return`binding-${++fq}`}function Xq(q){let Q=pq();if(!N.has(Q))N.set(Q,new Set);if(N.get(Q).add(q),!C.has(q.element))C.set(q.element,new Set);return C.get(q.element).add(q),Q}function Yq(q){let Q=N.get(q);if(Q)Q.forEach((Z)=>{let J=C.get(Z.element);if(J){if(J.delete(Z),J.size===0)C.delete(Z.element)}}),N.delete(q)}function Jq(q,Q){let{element:Z,type:J,attribute:$,transform:X}=q,Y=X?X(Q):Q;switch(J){case"text":if(Z instanceof HTMLElement||Z instanceof SVGElement)Z.textContent=String(Y??"");break;case"html":if(Z instanceof HTMLElement)Z.innerHTML=String(Y??"");break;case"value":if(Z instanceof HTMLInputElement||Z instanceof HTMLTextAreaElement||Z instanceof HTMLSelectElement){if(Z.value!==String(Y??""))Z.value=String(Y??"")}break;case"checked":if(Z instanceof HTMLInputElement)Z.checked=Boolean(Y);break;case"class":if(Z instanceof Element){if($)if(Y)Z.classList.add($);else Z.classList.remove($);else if(typeof Y==="string")Z.className=Y;else if(Array.isArray(Y))Z.className=Y.join(" ");else if(typeof Y==="object"&&Y!==null)Object.entries(Y).forEach(([z,G])=>{if(G)Z.classList.add(z);else Z.classList.remove(z)})}break;case"style":if(Z instanceof HTMLElement||Z instanceof SVGElement){if($)Z.style[$]=String(Y??"");else if(typeof Y==="string")Z.setAttribute("style",Y);else if(typeof Y==="object"&&Y!==null)Object.entries(Y).forEach(([z,G])=>{Z.style[z]=G})}break;case"attr":if($)if(Y===null||Y===void 0||Y===!1)Z.removeAttribute($);else if(Y===!0)Z.setAttribute($,"");else Z.setAttribute($,String(Y));break;case"prop":if($&&Z instanceof HTMLElement)Z[$]=Y;break}}function zq(q,Q,Z={}){let J={type:Z.type||"text",key:Z.key||"",element:q,attribute:Z.attribute,transform:Z.transform},$=Xq(J);console.log("[GoSPA DEBUG] bindElement called - key:",Z.key,"type:",J.type,"initial value:",Q.get()),Jq(J,Q.get());let X=Q.subscribe((Y)=>{console.log("[GoSPA DEBUG] bindElement subscriber callback - key:",Z.key,"value:",Y),Jq(J,Y)});return()=>{X(),Yq($)}}function Gq(q,Q){let Z=q instanceof HTMLInputElement&&q.type==="checkbox",J=q instanceof HTMLInputElement&&q.type==="radio",$=q instanceof HTMLInputElement&&q.type==="number";if(Z)q.checked=Boolean(Q.get());else q.value=String(Q.get()??"");let X=Q.subscribe((z)=>{if(Z)q.checked=Boolean(z);else if(q.value!==String(z??""))q.value=String(z??"")}),Y=()=>{let z;if(Z)z=q.checked;else if($)z=q.value?parseFloat(q.value):0;else z=q.value;D(()=>{Q.set(z)})};return q.addEventListener("input",Y),q.addEventListener("change",Y),()=>{X(),q.removeEventListener("input",Y),q.removeEventListener("change",Y)}}function uq(q,Q,Z){let J=null,$=(Y)=>{if(Y){if(!J)J=Q()}else if(J&&Z)J=Z();else J=null};$(q.get());let X=q.subscribe($);return{element:J,cleanup:()=>{X()}}}function mq(q,Q,Z){let J=document.createDocumentFragment(),$=document.createElement("div");J.appendChild($);let X=new Map,Y=(G)=>{let F=new Set;G.forEach((U,_)=>{let L=Z(U,_);if(F.add(L),!X.has(L)){let W=Q(U,_);X.set(L,{element:W,index:_});let u=$.children[_]||null;$.insertBefore(W,u)}else{let W=X.get(L);if(W.index=_,$.children[_]!==W.element)$.insertBefore(W.element,$.children[_]||null)}}),X.forEach((U,_)=>{if(!F.has(_))U.element.remove(),X.delete(_)})};Y(q.get());let z=q.subscribe(Y);return{container:$,cleanup:()=>{z(),X.clear()}}}var cq={prevent:(q,Q)=>{return q.preventDefault(),Q(q)},stop:(q,Q)=>{return q.stopPropagation(),Q(q)},capture:(q,Q)=>Q(q),once:(q,Q)=>Q(q),passive:(q,Q)=>Q(q),self:(q,Q)=>{if(q.target===q.currentTarget)return Q(q)}},R=new WeakMap;function Uq(q,Q){return(Z)=>{for(let $ of Q){if($==="capture"||$==="once"||$==="passive")continue;let X=cq[$];X(Z,q)}if(Q.filter(($)=>!["capture","once","passive"].includes($)).length===0)return q(Z)}}function m(q){let Q=q.split(":"),Z=Q[0],J=Q.slice(1);return{event:Z,modifiers:J}}function c(q,Q,Z){let{event:J,modifiers:$}=m(Q),X={capture:$.includes("capture"),once:$.includes("once"),passive:$.includes("passive")},Y=Uq(Z,$);if(q.addEventListener(J,Y,X),!R.has(q))R.set(q,new Map);let z=R.get(q);if(!z.has(Q))z.set(Q,new Set);return z.get(Q).add(Y),()=>{q.removeEventListener(J,Y,X);let G=z.get(Q);if(G){if(G.delete(Y),G.size===0)z.delete(Q)}}}function dq(q){let Q=R.get(q);if(!Q)return;for(let[Z,J]of Q){let{event:$,modifiers:X}=m(Z),Y={capture:X.includes("capture")};for(let z of J)q.removeEventListener($,z,Y)}R.delete(q)}function Fq(q,Q){let Z=null;return(J)=>{if(Z)clearTimeout(Z);Z=setTimeout(()=>{q(J),Z=null},Q)}}function _q(q,Q){let Z=!1;return(J)=>{if(!Z)q(J),Z=!0,setTimeout(()=>{Z=!1},Q)}}var rq={value:(q)=>q.target.value,checked:(q)=>q.target.checked,numberValue:(q)=>Number(q.target.value),files:(q)=>q.target.files,formData:(q)=>{return q.preventDefault(),new FormData(q.target)}};function lq(q,Q,Z,J){let{event:$,modifiers:X}=m(Z),Y=(G)=>{if(G.target.closest(Q))Uq(J,X)(G)},z={capture:X.includes("capture"),passive:X.includes("passive")};return q.addEventListener($,Y,z),()=>{q.removeEventListener($,Y,z)}}function sq(q,Q,Z){let J=Array.isArray(q)?q:[q];return($)=>{if(J.includes($.key)){if(Z?.preventDefault)$.preventDefault();Q($)}}}var iq={enter:"Enter",escape:"Escape",tab:"Tab",space:" ",arrowUp:"ArrowUp",arrowDown:"ArrowDown",arrowLeft:"ArrowLeft",arrowRight:"ArrowRight"};var Wq="gospa_session";function oq(){try{let q=localStorage.getItem(Wq);if(q)return JSON.parse(q)}catch(q){console.warn("[GoSPA] Failed to load session:",q)}return null}function aq(q){try{localStorage.setItem(Wq,JSON.stringify(q))}catch(Q){console.warn("[GoSPA] Failed to save session:",Q)}}class d{ws=null;config;reconnectAttempts=0;heartbeatTimer=null;messageQueue=[];connectionState;pendingRequests=new Map;requestId=0;sessionData=null;constructor(q){this.config={reconnect:!0,reconnectInterval:1000,maxReconnectAttempts:10,heartbeatInterval:30000,onOpen:()=>{},onClose:()=>{},onError:()=>{},onMessage:()=>{},...q},this.connectionState=new A("disconnected"),this.sessionData=oq()}get state(){return this.connectionState.get()}get isConnected(){return this.connectionState.get()==="connected"}connect(){return new Promise((q,Q)=>{if(this.ws?.readyState===WebSocket.OPEN){q();return}this.connectionState.set("connecting");let Z=this.config.url;if(this.sessionData?.token){let J=Z.includes("?")?"&":"?";Z=`${Z}${J}session=${encodeURIComponent(this.sessionData.token)}`}try{this.ws=new WebSocket(Z)}catch(J){this.connectionState.set("disconnected"),Q(J);return}this.ws.onopen=()=>{this.connectionState.set("connected"),this.reconnectAttempts=0,this.startHeartbeat(),this.flushMessageQueue(),this.send({type:"sync"}),this.config.onOpen(),q()},this.ws.onclose=(J)=>{if(this.connectionState.set("disconnected"),this.stopHeartbeat(),this.config.onClose(J),this.config.reconnect&&this.reconnectAttempts<this.config.maxReconnectAttempts)this.scheduleReconnect()},this.ws.onerror=(J)=>{if(this.config.onError(J),this.connectionState.get()==="connecting")Q(Error("WebSocket connection failed"))},this.ws.onmessage=(J)=>{this.handleMessage(J.data)}})}disconnect(){if(this.ws)this.connectionState.set("disconnecting"),this.stopHeartbeat(),this.ws.close(1000,"Client disconnect"),this.ws=null,this.connectionState.set("disconnected")}scheduleReconnect(){this.reconnectAttempts++;let q=this.config.reconnectInterval*Math.min(this.reconnectAttempts,5);setTimeout(()=>{if(this.connectionState.get()==="disconnected")this.connect().catch(()=>{})},q)}startHeartbeat(){this.heartbeatTimer=setInterval(()=>{this.send({type:"ping"})},this.config.heartbeatInterval)}stopHeartbeat(){if(this.heartbeatTimer)clearInterval(this.heartbeatTimer),this.heartbeatTimer=null}flushMessageQueue(){while(this.messageQueue.length>0&&this.isConnected){let q=this.messageQueue.shift();if(q)this.send(q)}}send(q){if(this.ws?.readyState===WebSocket.OPEN)this.ws.send(JSON.stringify(q));else this.messageQueue.push(q)}sendWithResponse(q){return new Promise((Q,Z)=>{let J=`req_${++this.requestId}`;q.data={...q.data,_requestId:J},this.pendingRequests.set(J,{resolve:Q,reject:Z}),this.send(q),setTimeout(()=>{if(this.pendingRequests.has(J))this.pendingRequests.delete(J),Z(Error("Request timeout"))},30000)})}handleMessage(q){try{let Q=JSON.parse(q);if(Q.type==="pong")return;if(Q.type==="init"&&Q.sessionToken&&Q.clientId)this.sessionData={token:Q.sessionToken,clientId:Q.clientId},aq(this.sessionData);if(Q.data?._responseId){let Z=Q.data._responseId,J=this.pendingRequests.get(Z);if(J)if(this.pendingRequests.delete(Z),Q.type==="error")J.reject(Error(Q.error||"Unknown error"));else J.resolve(Q.data)}this.config.onMessage(Q)}catch(Q){console.error("Failed to parse WebSocket message:",Q)}}requestSync(){this.send({type:"sync"})}sendAction(q,Q={}){this.send({type:"action",action:q,payload:Q})}requestState(q){return this.sendWithResponse({type:"init",componentId:q})}}function jq(q,Q={}){if(M)M.sendAction(q,Q);else console.warn("[GoSPA] Cannot send action: WebSocket not initialized")}var M=null;function h(){return M}function Hq(q){if(M)M.disconnect();return M=new d(q),M}function nq(q,Q){let Z=new A(q),J=Q.ws||M,$=!1,X=Z.set.bind(Z);return Z.set=(Y)=>{if($){X(Y);return}let z=Z.get();if(X(Y),J?.isConnected)try{let G=()=>{J.send({type:"update",payload:{key:Q.key,value:Y}})};if(Q.debounce)setTimeout(G,Q.debounce);else G()}catch(G){console.warn("[GoSPA] Optimistic update failed, rolling back.",G),$=!0,X(z),$=!1}else console.warn("[GoSPA] WS disconnected, optimistic update rolled back."),$=!0,X(z),$=!1},Z}function tq(q,Q){D(()=>{for(let[Z,J]of Object.entries(Q)){let $=q[Z];if($)$.set(J)}})}var H={currentPath:window.location.pathname,isNavigating:!1,pendingNavigation:null},b=new Set,y=new Set;function Kq(q){return b.add(q),()=>b.delete(q)}function Lq(q){return y.add(q),()=>y.delete(q)}function eq(q){let Q=q.getAttribute("href");if(!Q||Q.startsWith("#")||Q.startsWith("javascript:"))return!1;if(Q.startsWith("http://")||Q.startsWith("https://")||Q.startsWith("//"))try{return new URL(Q,window.location.origin).origin===window.location.origin}catch{return!1}if(q.hasAttribute("data-external")||q.hasAttribute("download")||q.getAttribute("target")==="_blank")return!1;return!0}var I=new Map;async function Oq(q){try{let Q=await fetch(q,{headers:{"X-Requested-With":"GoSPA-Navigate",Accept:"text/html"}});if(!Q.ok)return console.error("[GoSPA] Navigation failed:",Q.status),null;let Z=await Q.text(),$=new DOMParser().parseFromString(Z,"text/html"),X=$.querySelector("main"),Y=X?X.innerHTML:$.body.innerHTML,z=$.querySelector("title")?.textContent||"",G=$.querySelector("head"),F=G?G.innerHTML:"";return{content:Y,title:z,head:F}}catch(Q){return console.error("[GoSPA] Navigation error:",Q),null}}async function Aq(q){let Q=I.get(q);if(Q)return I.delete(q),Q;return Oq(q)}function Mq(q){if(q.title)document.title=q.title;let Q=document.querySelector("main");if(Q)Q.innerHTML=q.content;else document.body.innerHTML=q.content;qQ(q.head),QQ()}function qQ(q){let J=new DOMParser().parseFromString(`<html><head>${q}</head></html>`,"text/html").querySelector("head");if(!J)return;document.head.querySelectorAll("[data-gospa-head]").forEach((X)=>X.remove()),J.querySelectorAll("title, meta, link, style, script").forEach((X)=>{if(X.tagName==="SCRIPT"&&!X.hasAttribute("data-gospa-head"))return;X.setAttribute("data-gospa-head","true"),document.head.appendChild(X.cloneNode(!0))})}function QQ(){let q=document.querySelectorAll("[data-on]"),Q=document.querySelectorAll("[data-bind]"),Z=window.__gospa__,J=Z?._ws;q.forEach(($)=>{let X=$.getAttribute("data-on");if(!X)return;let[Y,z]=X.split(":");if(!Y||!z)return;let G=$.cloneNode(!0);$.parentNode?.replaceChild(G,$),G.addEventListener(Y,()=>{if(J&&J.readyState===WebSocket.OPEN)J.send(JSON.stringify({action:z}))})}),Q.forEach(($)=>{let X=$.getAttribute("data-bind");if(!X)return;let[Y,z]=X.split(":");if(!Y||!z)return;let G=Z?.state?.get(z);if(!G)return;let F=(U)=>{switch(Y){case"text":$.textContent=U;break;case"html":$.innerHTML=U;break;case"value":$.value=U;break;case"checked":$.checked=U;break;case"show":$.style.display=U?"":"none";break}};F(G.get()),G.subscribe(F)})}async function w(q,Q={}){if(q===H.currentPath&&!Q.replace)return!1;if(H.pendingNavigation)await H.pendingNavigation;H.isNavigating=!0,b.forEach((Z)=>Z(q));try{return H.pendingNavigation=(async()=>{let Z=await Aq(q);if(!Z)return window.location.href=q,!1;if(Q.replace)window.history.replaceState({path:q},"",q);else window.history.pushState({path:q},"",q);if(H.currentPath=q,Mq(Z),Q.scrollToTop!==!1)window.scrollTo(0,0);return y.forEach((J)=>J(q)),!0})(),await H.pendingNavigation}finally{H.isNavigating=!1,H.pendingNavigation=null}}function r(){window.history.back()}function l(){window.history.forward()}function s(q){window.history.go(q)}function Bq(){return H.currentPath}function Dq(){return H.isNavigating}function Pq(q){let Q=window.location.pathname;b.forEach((Z)=>Z(Q)),Aq(Q).then((Z)=>{if(Z)H.currentPath=Q,Mq(Z),y.forEach((J)=>J(Q));else window.location.reload()})}function Tq(q){if(q.button!==0||q.metaKey||q.ctrlKey||q.shiftKey||q.altKey)return;let Z=q.target.closest("a[href]");if(!Z)return;if(!eq(Z))return;q.preventDefault();let J=Z.getAttribute("href");if(!J)return;w(J)}function g(){document.addEventListener("click",Tq),window.addEventListener("popstate",Pq),document.documentElement.setAttribute("data-gospa-spa","true"),console.log("[GoSPA] SPA navigation initialized")}function xq(){document.removeEventListener("click",Tq),window.removeEventListener("popstate",Pq),document.documentElement.removeAttribute("data-gospa-spa")}async function i(q){if(I.has(q))return;let Q=await Oq(q);if(Q)I.set(q,Q),setTimeout(()=>I.delete(q),30000)}function Nq(){return{get path(){return H.currentPath},get isNavigating(){return H.isNavigating},navigate:w,back:r,forward:l,go:s,prefetch:i}}if(typeof document<"u")if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",g);else g();var ZQ=(q)=>q,Iq=(q)=>{let Q=q-1;return Q*Q*Q+1};function o(q,{delay:Q=0,duration:Z=400,easing:J=ZQ}={}){let $=+getComputedStyle(q).opacity;return{delay:Q,duration:Z,easing:"linear",css:(X)=>`opacity: ${X*$}`}}function a(q,{delay:Q=0,duration:Z=400,easing:J=Iq,x:$=0,y:X=0,opacity:Y=0}={}){let z=getComputedStyle(q),G=+z.opacity,F=z.transform==="none"?"":z.transform;return{delay:Q,duration:Z,easing:"ease-out",css:(U,_)=>`
			transform: ${F} translate(${(1-U)*$}px, ${(1-U)*X}px);
			opacity: ${G-(G-Y)*_}
		`}}function n(q,{delay:Q=0,duration:Z=400,easing:J=Iq}={}){let $=getComputedStyle(q),X=+$.opacity,Y=parseFloat($.height),z=parseFloat($.paddingTop),G=parseFloat($.paddingBottom),F=parseFloat($.marginTop),U=parseFloat($.marginBottom),_=parseFloat($.borderTopWidth),L=parseFloat($.borderBottomWidth);return{delay:Q,duration:Z,easing:"ease-out",css:(W)=>`
			overflow: hidden;
			opacity: ${Math.min(W*20,1)*X};
			height: ${W*Y}px;
			padding-top: ${W*z}px;
			padding-bottom: ${W*G}px;
			margin-top: ${W*F}px;
			margin-bottom: ${W*U}px;
			border-top-width: ${W*_}px;
			border-bottom-width: ${W*L}px;
		`}}var B=new Set;function $Q(q,Q,Z){if(B.has(q))return;B.add(q);let J=Q(q,Z),$=J.duration||400,X=J.delay||0,Y=J.css||(()=>""),z=q.getAttribute("style")||"",G=`gospa-transition-${Math.random().toString(36).substring(2,9)}`,F=`
		@keyframes ${G} {
			0% { ${Y(0,1)} }
			100% { ${Y(1,0)} }
		}
	`,U=document.createElement("style");U.textContent=F,document.head.appendChild(U),q.style.animation=`${G} ${$}ms ${J.easing||"linear"} ${X}ms both`,setTimeout(()=>{q.setAttribute("style",z),q.style.animation="",U.remove(),B.delete(q)},$+X)}function JQ(q,Q,Z,J){if(B.has(q))return;B.add(q);let $=Q(q,Z),X=$.duration||400,Y=$.delay||0,z=$.css||(()=>""),G=`gospa-transition-${Math.random().toString(36).substring(2,9)}`,F=`
		@keyframes ${G} {
			0% { ${z(1,0)} }
			100% { ${z(0,1)} }
		}
	`,U=document.createElement("style");U.textContent=F,document.head.appendChild(U),q.style.animation=`${G} ${X}ms ${$.easing||"linear"} ${Y}ms both`,setTimeout(()=>{U.remove(),B.delete(q),J()},X+Y)}function t(q=document.body){new MutationObserver((Z)=>{Z.forEach((J)=>{if(J.type==="childList")J.addedNodes.forEach(($)=>{if($.nodeType===Node.ELEMENT_NODE){let X=$;if(X.closest("[data-gospa-static]"))return;let Y=X.getAttribute("data-transition-in")||X.getAttribute("data-transition");if(Y){let z=Cq(Y);if(z)$Q(X,z,Rq(X))}}}),J.removedNodes.forEach(($)=>{if($.nodeType===Node.ELEMENT_NODE){let X=$;if(X.closest("[data-gospa-static]"))return;let Y=X.getAttribute("data-transition-out")||X.getAttribute("data-transition");if(Y){let z=Cq(Y);if(z&&!B.has(X)){let G=X.cloneNode(!0);if(G.querySelectorAll("[data-bind]").forEach((F)=>F.removeAttribute("data-bind")),G.removeAttribute("data-bind"),J.previousSibling&&J.previousSibling.parentNode)J.previousSibling.parentNode.insertBefore(G,J.previousSibling.nextSibling);else if(J.target)J.target.appendChild(G);JQ(G,z,Rq(X),()=>G.remove())}}}})})}).observe(q,{childList:!0,subtree:!0})}function Cq(q){if(q.startsWith("fade"))return o;if(q.startsWith("fly"))return a;if(q.startsWith("slide"))return n;return null}function Rq(q){let Q=q.getAttribute("data-transition-params");if(!Q)return{};try{return JSON.parse(Q)}catch(Z){return console.warn("Invalid transition parameters:",Q),{}}}var j=new Map,v=new x,wq=!1,K={};function Vq(q={}){if(wq){console.warn("GoSPA runtime already initialized");return}if(K=q,wq=!0,t(),K.wsUrl)Hq({url:K.wsUrl,onMessage:XQ}).connect().catch((Z)=>{if(K.debug)console.error("WebSocket connection failed:",Z)});if(window.addEventListener("error",(Q)=>{if(K.debug)console.error("Runtime error:",Q.error)}),K.debug)console.log("GoSPA runtime initialized");window.__GOSPA__={config:K,components:j,globalState:v,init:Vq,createComponent:e,destroyComponent:Sq,getComponent:kq,getState:qq,setState:hq,callAction:Qq,bind:f,autoInit:p,sendAction:jq,getWebSocketClient:h,navigate:w}}function XQ(q){switch(console.log("[GoSPA DEBUG] handleServerMessage received:",JSON.stringify(q)),q.type){case"init":if(q.componentId&&q.data){let Q=j.get(q.componentId);if(Q)Q.states.fromJSON(q.data)}else if(q.state){let Q=q.state;for(let[Z,J]of Object.entries(Q)){let $=Z.indexOf(".");if($>0){let X=Z.substring(0,$),Y=Z.substring($+1),z=j.get(X);if(z)console.log(`[GoSPA DEBUG] Restoring state: component=${X}, key=${Y}, value=${J}`),z.states.set(Y,J)}else{for(let X of j.values())if(X.states.get(Z)!==void 0)X.states.set(Z,J);v.set(Z,J)}}}break;case"update":if(q.componentId&&q.diff){let Q=j.get(q.componentId);if(Q)Q.states.fromJSON(q.diff)}break;case"sync":if(console.log("[GoSPA DEBUG] sync message - data:",q.data,"key:",q.key,"value:",q.value,"componentId:",q.componentId),q.data)v.fromJSON(q.data);else if(q.key!==void 0&&q.value!==void 0){let{key:Q,value:Z,componentId:J}=q;if(J){let $=j.get(J);if($)console.log(`[GoSPA DEBUG] Setting state for component ${J}: ${Q} = ${Z}`),$.states.set(Q,Z)}else{console.log("[GoSPA DEBUG] Processing partial sync. Components count:",j.size);for(let $ of j.values()){let X=$.states.get(Q);if(console.log("[GoSPA DEBUG] Component:",$.id,"key:",Q,"existingRune:",X?"exists":"not found"),X!==void 0)console.log("[GoSPA DEBUG] Setting state key:",Q,"to value:",Z),$.states.set(Q,Z)}v.set(Q,Z)}}break;case"error":if(K.debug)console.error("Server error:",q.error);break}}var Eq="gospa_local_";function YQ(q){try{let Q=Eq+q,Z=localStorage.getItem(Q);if(Z)return JSON.parse(Z)}catch(Q){if(K.debug)console.warn(`[GoSPA] Failed to load local state for ${q}:`,Q)}return null}function zQ(q,Q){try{let Z=Eq+q;localStorage.setItem(Z,JSON.stringify(Q))}catch(Z){if(K.debug)console.warn(`[GoSPA] Failed to save local state for ${q}:`,Z)}}function e(q,Q,Z=!1){let J={id:q.id,definition:q,states:new x,derived:new Map,unsubscribers:[],cleanup:[],element:Q||null,isLocal:Z};if(Z){let $=YQ(q.id);if($)for(let[X,Y]of Object.entries($))J.states.set(X,Y)}for(let[$,X]of Object.entries(q.state))if(!Z||J.states.get($)===void 0)J.states.set($,X);if(Z)for(let $ of Object.keys(q.state)){let X=J.states.get($);if(X){let Y=k(X,()=>{zQ(q.id,J.states.toJSON())});J.unsubscribers.push(Y)}}if(q.computed)for(let[$,X]of Object.entries(q.computed)){let Y=new S(X);J.derived.set($,Y)}if(q.watch)for(let[$,X]of Object.entries(q.watch)){let Y=J.states.get($);if(Y){let z=k(Y,X);J.unsubscribers.push(z)}}if(q.mount){let $=q.mount();if($)J.cleanup.push($)}if(j.set(q.id,J),K.debug)console.log(`Component "${q.name}" created with id "${q.id}"`);return J}function Sq(q){let Q=j.get(q);if(!Q)return;if(Q.definition.destroy)Q.definition.destroy();for(let Z of Q.cleanup)Z();for(let Z of Q.unsubscribers)Z();for(let Z of Q.derived.values())Z.dispose();if(j.delete(q),K.debug)console.log(`Component "${q}" destroyed`)}function kq(q){return j.get(q)}function qq(q,Q){return j.get(q)?.states.get(Q)}function hq(q,Q,Z){let J=j.get(q);if(J){if(J.states.set(Q,Z),!J.isLocal){let $=h();if($?.isConnected)$.send({type:"update",componentId:q,payload:{key:Q,value:Z}})}}}function Qq(q,Q,...Z){let J=j.get(q);if(!J||!J.definition.actions)throw Error(`Action "${Q}" not found on component "${q}"`);let $=J.definition.actions[Q];if(!$)throw Error(`Action "${Q}" not found on component "${q}"`);return $(...Z)}function f(q,Q,Z,J,$){let X=qq(q,J);if(!X)return console.warn(`State "${J}" not found on component "${q}"`),()=>{};if($?.twoWay)return Gq(Q,X);return zq(Q,X,{type:Z,transform:$?.transform})}function p(){let q=document.querySelectorAll("[data-gospa-component]");for(let Q of q){let Z=Q.getAttribute("data-gospa-component"),J=Q.getAttribute("data-gospa-state"),$=Q.hasAttribute("data-gospa-local");if(!Z)continue;let X=J?JSON.parse(J):{};e({id:Z,name:Z,state:X},Q,$)}GQ()}function GQ(){let q=document.querySelectorAll("[data-gospa-component]");console.log("[GoSPA DEBUG] Found components with data-gospa-component:",q.length),q.forEach(($,X)=>{console.log(`[GoSPA DEBUG] Component ${X}:`,$.getAttribute("data-gospa-component"),$)});let Q=document.querySelectorAll("[data-bind]");for(let $ of Q){let X=$.closest("[data-gospa-component]"),Y=X?.getAttribute("data-gospa-component")||"";console.log("[GoSPA DEBUG] setupBindings - element:",$,"closest component:",X,"componentId:",Y);let z=$.getAttribute("data-bind"),G=$.getAttribute("data-transform");if(!z)continue;let[F,U="text"]=z.split(":").map((L)=>L.trim()),_;if(G){if(_=window[G],typeof _!=="function"&&K.debug)console.warn(`[GoSPA] Transform "${G}" not found or not a function`)}f(Y,$,U,F,{transform:_})}let Z=document.querySelectorAll("[data-on]");for(let $ of Z){let X=$.closest("[data-gospa-component]")?.getAttribute("data-gospa-component")||"",Y=$.getAttribute("data-on");if(!Y)continue;let[z,G,F]=Y.split(":").map((_)=>_.trim()),U=F?F.split(",").map((_)=>_.trim()):[];c($,z,()=>{try{Qq(X,G,...U)}catch(_){let L=h();if(L?.isConnected){let W={};U.forEach((u)=>{let[bq,Zq]=u.split("=");if(Zq!==void 0)W[bq]=Zq}),L.sendAction(G,Object.keys(W).length>0?W:void 0)}else if(K.debug)console.error(`[GoSPA] Failed to execute action "${G}":`,_)}})}let J=document.querySelectorAll("[data-model]");for(let $ of J){let X=$.closest("[data-gospa-component]")?.getAttribute("data-gospa-component")||"",Y=$.getAttribute("data-model");if(!Y)continue;f(X,$,"value",Y,{twoWay:!0})}}if(typeof document<"u"){if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",()=>{if(document.documentElement.hasAttribute("data-gospa-auto"))p()});else if(document.documentElement.hasAttribute("data-gospa-auto"))p()}var xQ={init:Vq,createComponent:e,destroyComponent:Sq,getComponent:kq,getState:qq,setState:hq,callAction:Qq,bind:f,autoInit:p,Rune:A,Derived:S,Effect:T,StateMap:x,batch:D,effect:$q,watch:k,on:c,debounce:Fq,throttle:_q,fade:o,fly:a,slide:n,setupTransitions:t,navigate:w,back:r,forward:l,go:s,prefetch:i,getCurrentPath:Bq,isNavigating:Dq,onBeforeNavigate:Kq,onAfterNavigate:Lq,initNavigation:g,destroyNavigation:xq,createNavigationState:Nq};export{k as watch,Yq as unregisterBinding,rq as transformers,_q as throttle,nq as syncedRune,n as slide,t as setupTransitions,hq as setState,mq as renderList,uq as renderIf,Xq as registerBinding,i as prefetch,sq as onKey,Kq as onBeforeNavigate,Lq as onAfterNavigate,c as on,dq as offAll,w as navigate,iq as keys,Dq as isNavigating,Hq as initWebSocket,g as initNavigation,Vq as init,s as go,h as getWebSocketClient,qq as getState,Bq as getCurrentPath,kq as getComponent,l as forward,a as fly,o as fade,$q as effect,xq as destroyNavigation,Sq as destroyComponent,lq as delegate,xQ as default,Fq as debounce,Nq as createNavigationState,e as createComponent,Qq as callAction,Gq as bindTwoWay,zq as bindElement,f as bind,D as batch,r as back,p as autoInit,tq as applyStateUpdate,d as WSClient,x as StateMap,A as Rune,T as Effect,S as Derived};
