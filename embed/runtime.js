var kq=0,yq=0,x=0,S=new Set,A=null,V=[];function D(q){x++;try{q()}finally{if(x--,x===0){let G=[...S];S.clear(),G.forEach((Q)=>Q.notify())}}}class H{_value;_id;_subscribers=new Set;_dirty=!1;constructor(q){this._value=q,this._id=++kq}get value(){return this.trackDependency(),this._value}set value(q){if(this._equal(this._value,q))return;let G=this._value;this._value=q,this._dirty=!0,this._notifySubscribers(G)}get(){return this.trackDependency(),this._value}set(q){this.value=q}update(q){this.value=q(this._value)}subscribe(q){return this._subscribers.add(q),()=>this._subscribers.delete(q)}_notifySubscribers(q){if(x>0){S.add(this);return}this.notify()}notify(){let q=this._value;this._subscribers.forEach((G)=>G(q,this._value))}_equal(q,G){return Object.is(q,G)||JSON.stringify(q)===JSON.stringify(G)}trackDependency(){if(A)A.addDependency(this)}toJSON(){return{id:this._id,value:this._value}}}class E{_value;_compute;_dependencies=new Set;_subscribers=new Set;_dirty=!0;_disposed=!1;constructor(q){this._compute=q,this._value=void 0,this._recompute()}get value(){if(this._dirty)this._recompute();return this.trackDependency(),this._value}get(){return this.value}subscribe(q){return this._subscribers.add(q),()=>this._subscribers.delete(q)}_recompute(){let q=new Set(this._dependencies);this._dependencies.clear();let G=A;A={addDependency:(X)=>{this._dependencies.add(X)}};try{this._value=this._compute(),this._dirty=!1}finally{A=G}this._dependencies.forEach((X)=>{if(!q.has(X))X.subscribe(()=>{this._dirty=!0,this._notifySubscribers()})})}_notifySubscribers(){if(x>0){S.add(this);return}this.notify()}notify(){if(this._dirty)this._recompute();let q=this._value;this._subscribers.forEach((G)=>G(q,this._value))}trackDependency(){if(A)A.addDependency(this)}dispose(){this._disposed=!0,this._dependencies.clear(),this._subscribers.clear()}}class P{_fn;_cleanup;_dependencies=new Set;_id;_active=!0;_disposed=!1;constructor(q){this._fn=q,this._id=++yq,this._cleanup=void 0,this._run()}_run(){if(!this._active||this._disposed)return;if(this._cleanup)this._cleanup(),this._cleanup=void 0;this._dependencies.clear(),V.push(this),A=this;try{this._cleanup=this._fn()}finally{V.pop(),A=V[V.length-1]||null}}addDependency(q){this._dependencies.add(q)}notify(){this._run()}pause(){this._active=!1}resume(){this._active=!0,this._run()}dispose(){if(this._cleanup)this._cleanup();this._disposed=!0,this._dependencies.clear()}}function Xq(q){return new P(q)}function f(q,G){let Q=Array.isArray(q)?q:[q],X=[];return Q.forEach((Y)=>{X.push(Y.subscribe((Z,_)=>{let $=Q.map((z)=>z.get()),U=Q.map((z)=>_);G(Array.isArray(q)?$:$[0],Array.isArray(q)?U:U[0])}))}),()=>X.forEach((Y)=>Y())}class T{_runes=new Map;set(q,G){let Q=new H(G);return this._runes.set(q,Q),Q}get(q){return this._runes.get(q)}has(q){return this._runes.has(q)}delete(q){return this._runes.delete(q)}clear(){this._runes.clear()}toJSON(){let q={};return this._runes.forEach((G,Q)=>{q[Q]=G.get()}),q}fromJSON(q){Object.entries(q).forEach(([G,Q])=>{if(this._runes.has(G))this._runes.get(G).set(Q);else this.set(G,Q)})}}function bq(...q){if(!(typeof window<"u"&&window.__GOSPA_DEV__!==!1))return{with:()=>{}};let Q=!0,X=[],Y=()=>q.map((_)=>typeof _==="function"?_():_),Z=(_)=>{let $=Y();console.log(`%c[${_}]`,"color: #888",...$),X.forEach((U)=>U(_,$))};return new P(()=>{if(Y(),Q)Q=!1,Z("init");else Z("update")}),{with:(_)=>{X.push(_)}}}bq.trace=(q)=>{if(!(typeof window<"u"&&window.__GOSPA_DEV__!==!1))return;console.log(`%c[trace]${q?` ${q}`:""}`,"color: #666; font-style: italic")};var N=new Map,C=new WeakMap,hq=0;function gq(){return`binding-${++hq}`}function Zq(q){let G=gq();if(!N.has(G))N.set(G,new Set);if(N.get(G).add(q),!C.has(q.element))C.set(q.element,new Set);return C.get(q.element).add(q),G}function _q(q){let G=N.get(q);if(G)G.forEach((Q)=>{let X=C.get(Q.element);if(X){if(X.delete(Q),X.size===0)C.delete(Q.element)}}),N.delete(q)}function Yq(q,G){let{element:Q,type:X,attribute:Y,transform:Z}=q,_=Z?Z(G):G;switch(X){case"text":if(Q instanceof HTMLElement||Q instanceof SVGElement)Q.textContent=String(_??"");break;case"html":if(Q instanceof HTMLElement)Q.innerHTML=String(_??"");break;case"value":if(Q instanceof HTMLInputElement||Q instanceof HTMLTextAreaElement||Q instanceof HTMLSelectElement){if(Q.value!==String(_??""))Q.value=String(_??"")}break;case"checked":if(Q instanceof HTMLInputElement)Q.checked=Boolean(_);break;case"class":if(Q instanceof Element){if(Y)if(_)Q.classList.add(Y);else Q.classList.remove(Y);else if(typeof _==="string")Q.className=_;else if(Array.isArray(_))Q.className=_.join(" ");else if(typeof _==="object"&&_!==null)Object.entries(_).forEach(([$,U])=>{if(U)Q.classList.add($);else Q.classList.remove($)})}break;case"style":if(Q instanceof HTMLElement||Q instanceof SVGElement){if(Y)Q.style[Y]=String(_??"");else if(typeof _==="string")Q.setAttribute("style",_);else if(typeof _==="object"&&_!==null)Object.entries(_).forEach(([$,U])=>{Q.style[$]=U})}break;case"attr":if(Y)if(_===null||_===void 0||_===!1)Q.removeAttribute(Y);else if(_===!0)Q.setAttribute(Y,"");else Q.setAttribute(Y,String(_));break;case"prop":if(Y&&Q instanceof HTMLElement)Q[Y]=_;break}}function $q(q,G,Q={}){let X={type:Q.type||"text",key:Q.key||"",element:q,attribute:Q.attribute,transform:Q.transform},Y=Zq(X);Yq(X,G.get());let Z=G.subscribe((_)=>{Yq(X,_)});return()=>{Z(),_q(Y)}}function Uq(q,G){let Q=q instanceof HTMLInputElement&&q.type==="checkbox",X=q instanceof HTMLInputElement&&q.type==="radio",Y=q instanceof HTMLInputElement&&q.type==="number";if(Q)q.checked=Boolean(G.get());else q.value=String(G.get()??"");let Z=G.subscribe(($)=>{if(Q)q.checked=Boolean($);else if(q.value!==String($??""))q.value=String($??"")}),_=()=>{let $;if(Q)$=q.checked;else if(Y)$=q.value?parseFloat(q.value):0;else $=q.value;D(()=>{G.set($)})};return q.addEventListener("input",_),q.addEventListener("change",_),()=>{Z(),q.removeEventListener("input",_),q.removeEventListener("change",_)}}function vq(q,G,Q){let X=null,Y=(_)=>{if(_){if(!X)X=G()}else if(X&&Q)X=Q();else X=null};Y(q.get());let Z=q.subscribe(Y);return{element:X,cleanup:()=>{Z()}}}function pq(q,G,Q){let X=document.createDocumentFragment(),Y=document.createElement("div");X.appendChild(Y);let Z=new Map,_=(U)=>{let z=new Set;U.forEach((J,F)=>{let j=Q(J,F);if(z.add(j),!Z.has(j)){let L=G(J,F);Z.set(j,{element:L,index:F});let p=Y.children[F]||null;Y.insertBefore(L,p)}else{let L=Z.get(j);if(L.index=F,Y.children[F]!==L.element)Y.insertBefore(L.element,Y.children[F]||null)}}),Z.forEach((J,F)=>{if(!z.has(F))J.element.remove(),Z.delete(F)})};_(q.get());let $=q.subscribe(_);return{container:Y,cleanup:()=>{$(),Z.clear()}}}var fq={prevent:(q,G)=>{return q.preventDefault(),G(q)},stop:(q,G)=>{return q.stopPropagation(),G(q)},capture:(q,G)=>G(q),once:(q,G)=>G(q),passive:(q,G)=>G(q),self:(q,G)=>{if(q.target===q.currentTarget)return G(q)}},I=new WeakMap;function Jq(q,G){return(Q)=>{for(let Y of G){if(Y==="capture"||Y==="once"||Y==="passive")continue;let Z=fq[Y];Z(Q,q)}if(G.filter((Y)=>!["capture","once","passive"].includes(Y)).length===0)return q(Q)}}function m(q){let G=q.split(":"),Q=G[0],X=G.slice(1);return{event:Q,modifiers:X}}function u(q,G,Q){let{event:X,modifiers:Y}=m(G),Z={capture:Y.includes("capture"),once:Y.includes("once"),passive:Y.includes("passive")},_=Jq(Q,Y);if(q.addEventListener(X,_,Z),!I.has(q))I.set(q,new Map);let $=I.get(q);if(!$.has(G))$.set(G,new Set);return $.get(G).add(_),()=>{q.removeEventListener(X,_,Z);let U=$.get(G);if(U){if(U.delete(_),U.size===0)$.delete(G)}}}function mq(q){let G=I.get(q);if(!G)return;for(let[Q,X]of G){let{event:Y,modifiers:Z}=m(Q),_={capture:Z.includes("capture")};for(let $ of X)q.removeEventListener(Y,$,_)}I.delete(q)}function zq(q,G){let Q=null;return(X)=>{if(Q)clearTimeout(Q);Q=setTimeout(()=>{q(X),Q=null},G)}}function Fq(q,G){let Q=!1;return(X)=>{if(!Q)q(X),Q=!0,setTimeout(()=>{Q=!1},G)}}var uq={value:(q)=>q.target.value,checked:(q)=>q.target.checked,numberValue:(q)=>Number(q.target.value),files:(q)=>q.target.files,formData:(q)=>{return q.preventDefault(),new FormData(q.target)}};function cq(q,G,Q,X){let{event:Y,modifiers:Z}=m(Q),_=(U)=>{if(U.target.closest(G))Jq(X,Z)(U)},$={capture:Z.includes("capture"),passive:Z.includes("passive")};return q.addEventListener(Y,_,$),()=>{q.removeEventListener(Y,_,$)}}function dq(q,G,Q){let X=Array.isArray(q)?q:[q];return(Y)=>{if(X.includes(Y.key)){if(Q?.preventDefault)Y.preventDefault();G(Y)}}}var sq={enter:"Enter",escape:"Escape",tab:"Tab",space:" ",arrowUp:"ArrowUp",arrowDown:"ArrowDown",arrowLeft:"ArrowLeft",arrowRight:"ArrowRight"};class c{ws=null;config;reconnectAttempts=0;heartbeatTimer=null;messageQueue=[];connectionState;pendingRequests=new Map;requestId=0;constructor(q){this.config={reconnect:!0,reconnectInterval:1000,maxReconnectAttempts:10,heartbeatInterval:30000,onOpen:()=>{},onClose:()=>{},onError:()=>{},onMessage:()=>{},...q},this.connectionState=new H("disconnected")}get state(){return this.connectionState.get()}get isConnected(){return this.connectionState.get()==="connected"}connect(){return new Promise((q,G)=>{if(this.ws?.readyState===WebSocket.OPEN){q();return}this.connectionState.set("connecting");try{this.ws=new WebSocket(this.config.url)}catch(Q){this.connectionState.set("disconnected"),G(Q);return}this.ws.onopen=()=>{this.connectionState.set("connected"),this.reconnectAttempts=0,this.startHeartbeat(),this.flushMessageQueue(),this.send({type:"sync"}),this.config.onOpen(),q()},this.ws.onclose=(Q)=>{if(this.connectionState.set("disconnected"),this.stopHeartbeat(),this.config.onClose(Q),this.config.reconnect&&this.reconnectAttempts<this.config.maxReconnectAttempts)this.scheduleReconnect()},this.ws.onerror=(Q)=>{if(this.config.onError(Q),this.connectionState.get()==="connecting")G(Error("WebSocket connection failed"))},this.ws.onmessage=(Q)=>{this.handleMessage(Q.data)}})}disconnect(){if(this.ws)this.connectionState.set("disconnecting"),this.stopHeartbeat(),this.ws.close(1000,"Client disconnect"),this.ws=null,this.connectionState.set("disconnected")}scheduleReconnect(){this.reconnectAttempts++;let q=this.config.reconnectInterval*Math.min(this.reconnectAttempts,5);setTimeout(()=>{if(this.connectionState.get()==="disconnected")this.connect().catch(()=>{})},q)}startHeartbeat(){this.heartbeatTimer=setInterval(()=>{this.send({type:"ping"})},this.config.heartbeatInterval)}stopHeartbeat(){if(this.heartbeatTimer)clearInterval(this.heartbeatTimer),this.heartbeatTimer=null}flushMessageQueue(){while(this.messageQueue.length>0&&this.isConnected){let q=this.messageQueue.shift();if(q)this.send(q)}}send(q){if(this.ws?.readyState===WebSocket.OPEN)this.ws.send(JSON.stringify(q));else this.messageQueue.push(q)}sendWithResponse(q){return new Promise((G,Q)=>{let X=`req_${++this.requestId}`;q.data={...q.data,_requestId:X},this.pendingRequests.set(X,{resolve:G,reject:Q}),this.send(q),setTimeout(()=>{if(this.pendingRequests.has(X))this.pendingRequests.delete(X),Q(Error("Request timeout"))},30000)})}handleMessage(q){try{let G=JSON.parse(q);if(G.type==="pong")return;if(G.data?._responseId){let Q=G.data._responseId,X=this.pendingRequests.get(Q);if(X)if(this.pendingRequests.delete(Q),G.type==="error")X.reject(Error(G.error||"Unknown error"));else X.resolve(G.data)}this.config.onMessage(G)}catch(G){console.error("Failed to parse WebSocket message:",G)}}requestSync(){this.send({type:"sync"})}sendAction(q,G={}){this.send({type:"action",action:q,payload:G})}requestState(q){return this.sendWithResponse({type:"init",componentId:q})}}function Lq(q,G={}){if(M)M.sendAction(q,G);else console.warn("[GoSPA] Cannot send action: WebSocket not initialized")}var M=null;function d(){return M}function Kq(q){if(M)M.disconnect();return M=new c(q),M}function oq(q,G){let Q=new H(q),X=G.ws||M,Y=!1,Z=Q.set.bind(Q);return Q.set=(_)=>{if(Y){Z(_);return}let $=Q.get();if(Z(_),X?.isConnected)try{let U=()=>{X.send({type:"update",payload:{key:G.key,value:_}})};if(G.debounce)setTimeout(U,G.debounce);else U()}catch(U){console.warn("[GoSPA] Optimistic update failed, rolling back.",U),Y=!0,Z($),Y=!1}else console.warn("[GoSPA] WS disconnected, optimistic update rolled back."),Y=!0,Z($),Y=!1},Q}function lq(q,G){D(()=>{for(let[Q,X]of Object.entries(G)){let Y=q[Q];if(Y)Y.set(X)}})}var K={currentPath:window.location.pathname,isNavigating:!1,pendingNavigation:null},k=new Set,y=new Set;function Oq(q){return k.add(q),()=>k.delete(q)}function Wq(q){return y.add(q),()=>y.delete(q)}function rq(q){let G=q.getAttribute("href");if(!G||G.startsWith("#")||G.startsWith("javascript:"))return!1;if(G.startsWith("http://")||G.startsWith("https://")||G.startsWith("//"))try{return new URL(G,window.location.origin).origin===window.location.origin}catch{return!1}if(q.hasAttribute("data-external")||q.hasAttribute("download")||q.getAttribute("target")==="_blank")return!1;return!0}var R=new Map;async function jq(q){try{let G=await fetch(q,{headers:{"X-Requested-With":"GoSPA-Navigate",Accept:"text/html"}});if(!G.ok)return console.error("[GoSPA] Navigation failed:",G.status),null;let Q=await G.text(),Y=new DOMParser().parseFromString(Q,"text/html"),Z=Y.querySelector("main"),_=Z?Z.innerHTML:Y.body.innerHTML,$=Y.querySelector("title")?.textContent||"",U=Y.querySelector("head"),z=U?U.innerHTML:"";return{content:_,title:$,head:z}}catch(G){return console.error("[GoSPA] Navigation error:",G),null}}async function Aq(q){let G=R.get(q);if(G)return R.delete(q),G;return jq(q)}function Hq(q){if(q.title)document.title=q.title;let G=document.querySelector("main");if(G)G.innerHTML=q.content;else document.body.innerHTML=q.content;iq(q.head),aq()}function iq(q){let X=new DOMParser().parseFromString(`<html><head>${q}</head></html>`,"text/html").querySelector("head");if(!X)return;document.head.querySelectorAll("[data-gospa-head]").forEach((Z)=>Z.remove()),X.querySelectorAll("title, meta, link, style, script").forEach((Z)=>{if(Z.tagName==="SCRIPT"&&!Z.hasAttribute("data-gospa-head"))return;Z.setAttribute("data-gospa-head","true"),document.head.appendChild(Z.cloneNode(!0))})}function aq(){let q=document.querySelectorAll("[data-on]"),G=document.querySelectorAll("[data-bind]"),Q=window.__gospa__,X=Q?._ws;q.forEach((Y)=>{let Z=Y.getAttribute("data-on");if(!Z)return;let[_,$]=Z.split(":");if(!_||!$)return;let U=Y.cloneNode(!0);Y.parentNode?.replaceChild(U,Y),U.addEventListener(_,()=>{if(X&&X.readyState===WebSocket.OPEN)X.send(JSON.stringify({action:$}))})}),G.forEach((Y)=>{let Z=Y.getAttribute("data-bind");if(!Z)return;let[_,$]=Z.split(":");if(!_||!$)return;let U=Q?.state?.get($);if(!U)return;let z=(J)=>{switch(_){case"text":Y.textContent=J;break;case"html":Y.innerHTML=J;break;case"value":Y.value=J;break;case"checked":Y.checked=J;break;case"show":Y.style.display=J?"":"none";break}};z(U.get()),U.subscribe(z)})}async function w(q,G={}){if(q===K.currentPath&&!G.replace)return!1;if(K.pendingNavigation)await K.pendingNavigation;K.isNavigating=!0,k.forEach((Q)=>Q(q));try{return K.pendingNavigation=(async()=>{let Q=await Aq(q);if(!Q)return window.location.href=q,!1;if(G.replace)window.history.replaceState({path:q},"",q);else window.history.pushState({path:q},"",q);if(K.currentPath=q,Hq(Q),G.scrollToTop!==!1)window.scrollTo(0,0);return y.forEach((X)=>X(q)),!0})(),await K.pendingNavigation}finally{K.isNavigating=!1,K.pendingNavigation=null}}function s(){window.history.back()}function o(){window.history.forward()}function l(q){window.history.go(q)}function Mq(){return K.currentPath}function Bq(){return K.isNavigating}function Dq(q){let G=window.location.pathname;k.forEach((Q)=>Q(G)),Aq(G).then((Q)=>{if(Q)K.currentPath=G,Hq(Q),y.forEach((X)=>X(G));else window.location.reload()})}function xq(q){if(q.button!==0||q.metaKey||q.ctrlKey||q.shiftKey||q.altKey)return;let Q=q.target.closest("a[href]");if(!Q)return;if(!rq(Q))return;q.preventDefault();let X=Q.getAttribute("href");if(!X)return;w(X)}function b(){document.addEventListener("click",xq),window.addEventListener("popstate",Dq),document.documentElement.setAttribute("data-gospa-spa","true"),console.log("[GoSPA] SPA navigation initialized")}function Pq(){document.removeEventListener("click",xq),window.removeEventListener("popstate",Dq),document.documentElement.removeAttribute("data-gospa-spa")}async function r(q){if(R.has(q))return;let G=await jq(q);if(G)R.set(q,G),setTimeout(()=>R.delete(q),30000)}function Tq(){return{get path(){return K.currentPath},get isNavigating(){return K.isNavigating},navigate:w,back:s,forward:o,go:l,prefetch:r}}if(typeof document<"u")if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",b);else b();var nq=(q)=>q,Iq=(q)=>{let G=q-1;return G*G*G+1};function i(q,{delay:G=0,duration:Q=400,easing:X=nq}={}){let Y=+getComputedStyle(q).opacity;return{delay:G,duration:Q,easing:"linear",css:(Z)=>`opacity: ${Z*Y}`}}function a(q,{delay:G=0,duration:Q=400,easing:X=Iq,x:Y=0,y:Z=0,opacity:_=0}={}){let $=getComputedStyle(q),U=+$.opacity,z=$.transform==="none"?"":$.transform;return{delay:G,duration:Q,easing:"ease-out",css:(J,F)=>`
			transform: ${z} translate(${(1-J)*Y}px, ${(1-J)*Z}px);
			opacity: ${U-(U-_)*F}
		`}}function n(q,{delay:G=0,duration:Q=400,easing:X=Iq}={}){let Y=getComputedStyle(q),Z=+Y.opacity,_=parseFloat(Y.height),$=parseFloat(Y.paddingTop),U=parseFloat(Y.paddingBottom),z=parseFloat(Y.marginTop),J=parseFloat(Y.marginBottom),F=parseFloat(Y.borderTopWidth),j=parseFloat(Y.borderBottomWidth);return{delay:G,duration:Q,easing:"ease-out",css:(L)=>`
			overflow: hidden;
			opacity: ${Math.min(L*20,1)*Z};
			height: ${L*_}px;
			padding-top: ${L*$}px;
			padding-bottom: ${L*U}px;
			margin-top: ${L*z}px;
			margin-bottom: ${L*J}px;
			border-top-width: ${L*F}px;
			border-bottom-width: ${L*j}px;
		`}}var B=new Set;function tq(q,G,Q){if(B.has(q))return;B.add(q);let X=G(q,Q),Y=X.duration||400,Z=X.delay||0,_=X.css||(()=>""),$=q.getAttribute("style")||"",U=`gospa-transition-${Math.random().toString(36).substring(2,9)}`,z=`
		@keyframes ${U} {
			0% { ${_(0,1)} }
			100% { ${_(1,0)} }
		}
	`,J=document.createElement("style");J.textContent=z,document.head.appendChild(J),q.style.animation=`${U} ${Y}ms ${X.easing||"linear"} ${Z}ms both`,setTimeout(()=>{q.setAttribute("style",$),q.style.animation="",J.remove(),B.delete(q)},Y+Z)}function eq(q,G,Q,X){if(B.has(q))return;B.add(q);let Y=G(q,Q),Z=Y.duration||400,_=Y.delay||0,$=Y.css||(()=>""),U=`gospa-transition-${Math.random().toString(36).substring(2,9)}`,z=`
		@keyframes ${U} {
			0% { ${$(1,0)} }
			100% { ${$(0,1)} }
		}
	`,J=document.createElement("style");J.textContent=z,document.head.appendChild(J),q.style.animation=`${U} ${Z}ms ${Y.easing||"linear"} ${_}ms both`,setTimeout(()=>{J.remove(),B.delete(q),X()},Z+_)}function t(q=document.body){new MutationObserver((Q)=>{Q.forEach((X)=>{if(X.type==="childList")X.addedNodes.forEach((Y)=>{if(Y.nodeType===Node.ELEMENT_NODE){let Z=Y;if(Z.closest("[data-gospa-static]"))return;let _=Z.getAttribute("data-transition-in")||Z.getAttribute("data-transition");if(_){let $=Nq(_);if($)tq(Z,$,Cq(Z))}}}),X.removedNodes.forEach((Y)=>{if(Y.nodeType===Node.ELEMENT_NODE){let Z=Y;if(Z.closest("[data-gospa-static]"))return;let _=Z.getAttribute("data-transition-out")||Z.getAttribute("data-transition");if(_){let $=Nq(_);if($&&!B.has(Z)){let U=Z.cloneNode(!0);if(U.querySelectorAll("[data-bind]").forEach((z)=>z.removeAttribute("data-bind")),U.removeAttribute("data-bind"),X.previousSibling&&X.previousSibling.parentNode)X.previousSibling.parentNode.insertBefore(U,X.previousSibling.nextSibling);else if(X.target)X.target.appendChild(U);eq(U,$,Cq(Z),()=>U.remove())}}}})})}).observe(q,{childList:!0,subtree:!0})}function Nq(q){if(q.startsWith("fade"))return i;if(q.startsWith("fly"))return a;if(q.startsWith("slide"))return n;return null}function Cq(q){let G=q.getAttribute("data-transition-params");if(!G)return{};try{return JSON.parse(G)}catch(Q){return console.warn("Invalid transition parameters:",G),{}}}var W=new Map,h=new T,Rq=!1,O={};function wq(q={}){if(Rq){console.warn("GoSPA runtime already initialized");return}if(O=q,Rq=!0,t(),O.wsUrl)Kq({url:O.wsUrl,onMessage:qG}).connect().catch((Q)=>{if(O.debug)console.error("WebSocket connection failed:",Q)});if(window.addEventListener("error",(G)=>{if(O.debug)console.error("Runtime error:",G.error)}),O.debug)console.log("GoSPA runtime initialized");window.__GOSPA__={config:O,components:W,globalState:h,init:wq,createComponent:e,destroyComponent:Vq,getComponent:Sq,getState:qq,setState:Eq,callAction:Gq,bind:g,autoInit:v,sendAction:Lq,getWebSocketClient:d,navigate:w}}function qG(q){switch(q.type){case"init":if(q.componentId&&q.data){let G=W.get(q.componentId);if(G)G.states.fromJSON(q.data)}else if(q.state){for(let G of W.values())for(let[Q,X]of Object.entries(q.state))if(G.states.get(Q)!==void 0)G.states.set(Q,X);h.fromJSON(q.state)}break;case"update":if(q.componentId&&q.diff){let G=W.get(q.componentId);if(G)G.states.fromJSON(q.diff)}break;case"sync":if(q.data)h.fromJSON(q.data);else if(q.key!==void 0&&q.value!==void 0){for(let G of W.values())if(G.states.get(q.key)!==void 0)G.states.set(q.key,q.value);h.set(q.key,q.value)}break;case"error":if(O.debug)console.error("Server error:",q.error);break}}function e(q,G){let Q={id:q.id,definition:q,states:new T,derived:new Map,unsubscribers:[],cleanup:[],element:G||null};for(let[X,Y]of Object.entries(q.state))Q.states.set(X,Y);if(q.computed)for(let[X,Y]of Object.entries(q.computed)){let Z=new E(Y);Q.derived.set(X,Z)}if(q.watch)for(let[X,Y]of Object.entries(q.watch)){let Z=Q.states.get(X);if(Z){let _=f(Z,Y);Q.unsubscribers.push(_)}}if(q.mount){let X=q.mount();if(X)Q.cleanup.push(X)}if(W.set(q.id,Q),O.debug)console.log(`Component "${q.name}" created with id "${q.id}"`);return Q}function Vq(q){let G=W.get(q);if(!G)return;if(G.definition.destroy)G.definition.destroy();for(let Q of G.cleanup)Q();for(let Q of G.unsubscribers)Q();for(let Q of G.derived.values())Q.dispose();if(W.delete(q),O.debug)console.log(`Component "${q}" destroyed`)}function Sq(q){return W.get(q)}function qq(q,G){return W.get(q)?.states.get(G)}function Eq(q,G,Q){let X=W.get(q);if(X)X.states.set(G,Q)}function Gq(q,G,...Q){let X=W.get(q);if(!X||!X.definition.actions)throw Error(`Action "${G}" not found on component "${q}"`);let Y=X.definition.actions[G];if(!Y)throw Error(`Action "${G}" not found on component "${q}"`);return Y(...Q)}function g(q,G,Q,X,Y){let Z=qq(q,X);if(!Z)return console.warn(`State "${X}" not found on component "${q}"`),()=>{};if(Y?.twoWay)return Uq(G,Z);return $q(G,Z,{type:Q,transform:Y?.transform})}function v(){let q=document.querySelectorAll("[data-gospa-component]");for(let G of q){let Q=G.getAttribute("data-gospa-component"),X=G.getAttribute("data-gospa-state");if(!Q)continue;let Y=X?JSON.parse(X):{};e({id:Q,name:Q,state:Y},G)}GG()}function GG(){let q=document.querySelectorAll("[data-bind]");for(let X of q){let Y=X.closest("[data-gospa-component]")?.getAttribute("data-gospa-component")||"",Z=X.getAttribute("data-bind"),_=X.getAttribute("data-transform");if(!Z)continue;let[$,U="text"]=Z.split(":").map((J)=>J.trim()),z;if(_){if(z=window[_],typeof z!=="function"&&O.debug)console.warn(`[GoSPA] Transform "${_}" not found or not a function`)}g(Y,X,U,$,{transform:z})}let G=document.querySelectorAll("[data-on]");for(let X of G){let Y=X.closest("[data-gospa-component]")?.getAttribute("data-gospa-component")||"",Z=X.getAttribute("data-on");if(!Z)continue;let[_,$,U]=Z.split(":").map((J)=>J.trim()),z=U?U.split(",").map((J)=>J.trim()):[];u(X,_,()=>{try{Gq(Y,$,...z)}catch(J){let F=d();if(F?.isConnected){let j={};z.forEach((L)=>{let[p,Qq]=L.split("=");if(Qq!==void 0)j[p]=Qq}),F.sendAction($,Object.keys(j).length>0?j:void 0)}else if(O.debug)console.error(`[GoSPA] Failed to execute action "${$}":`,J)}})}let Q=document.querySelectorAll("[data-model]");for(let X of Q){let Y=X.closest("[data-gospa-component]")?.getAttribute("data-gospa-component")||"",Z=X.getAttribute("data-model");if(!Z)continue;g(Y,X,"value",Z,{twoWay:!0})}}if(typeof document<"u"){if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",()=>{if(document.documentElement.hasAttribute("data-gospa-auto"))v()});else if(document.documentElement.hasAttribute("data-gospa-auto"))v()}var AG={init:wq,createComponent:e,destroyComponent:Vq,getComponent:Sq,getState:qq,setState:Eq,callAction:Gq,bind:g,autoInit:v,Rune:H,Derived:E,Effect:P,StateMap:T,batch:D,effect:Xq,watch:f,on:u,debounce:zq,throttle:Fq,fade:i,fly:a,slide:n,setupTransitions:t,navigate:w,back:s,forward:o,go:l,prefetch:r,getCurrentPath:Mq,isNavigating:Bq,onBeforeNavigate:Oq,onAfterNavigate:Wq,initNavigation:b,destroyNavigation:Pq,createNavigationState:Tq};export{f as watch,_q as unregisterBinding,uq as transformers,Fq as throttle,oq as syncedRune,n as slide,t as setupTransitions,Eq as setState,pq as renderList,vq as renderIf,Zq as registerBinding,r as prefetch,dq as onKey,Oq as onBeforeNavigate,Wq as onAfterNavigate,u as on,mq as offAll,w as navigate,sq as keys,Bq as isNavigating,Kq as initWebSocket,b as initNavigation,wq as init,l as go,d as getWebSocketClient,qq as getState,Mq as getCurrentPath,Sq as getComponent,o as forward,a as fly,i as fade,Xq as effect,Pq as destroyNavigation,Vq as destroyComponent,cq as delegate,AG as default,zq as debounce,Tq as createNavigationState,e as createComponent,Gq as callAction,Uq as bindTwoWay,$q as bindElement,g as bind,D as batch,s as back,v as autoInit,lq as applyStateUpdate,c as WSClient,T as StateMap,H as Rune,P as Effect,E as Derived};
