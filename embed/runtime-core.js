import{O as d,P as r,Q as L,R as w,S as s,T as a}from"./runtime-emnwg501.js";import{$ as i,X as c,Y as l,Z as E,_ as m,aa as D,ba as T}from"./runtime-zmh0xn4h.js";import{ja as x,ka as z}from"./runtime-nmjc1qqb.js";var h={prevent:(q,Q)=>{return q.preventDefault(),Q(q)},stop:(q,Q)=>{return q.stopPropagation(),Q(q)},capture:(q,Q)=>Q(q),once:(q,Q)=>Q(q),passive:(q,Q)=>Q(q),self:(q,Q)=>{if(q.target===q.currentTarget)return Q(q)}},P=new WeakMap;function A(q,Q){return(U)=>{for(let Z of Q){if(Z==="capture"||Z==="once"||Z==="passive")continue;let $=h[Z];$(U,q)}if(Q.filter((Z)=>!["capture","once","passive"].includes(Z)).length===0)return q(U)}}function B(q){let Q=q.split(":"),U=Q[0],Y=Q.slice(1);return{event:U,modifiers:Y}}function C(q,Q,U){let{event:Y,modifiers:Z}=B(Q),$={capture:Z.includes("capture"),once:Z.includes("once"),passive:Z.includes("passive")},j=A(U,Z);if(q.addEventListener(Y,j,$),!P.has(q))P.set(q,new Map);let V=P.get(q);if(!V.has(Q))V.set(Q,new Set);return V.get(Q).add(j),()=>{q.removeEventListener(Y,j,$);let F=V.get(Q);if(F){if(F.delete(j),F.size===0)V.delete(Q)}}}function S(q){let Q=P.get(q);if(!Q)return;for(let[U,Y]of Q){let{event:Z,modifiers:$}=B(U),j={capture:$.includes("capture")};for(let V of Y)q.removeEventListener(Z,V,j)}P.delete(q)}function y(q,Q){let U=null;return(Y)=>{if(U)clearTimeout(U);U=setTimeout(()=>{q(Y),U=null},Q)}}function u(q,Q){let U=!1;return(Y)=>{if(!U)q(Y),U=!0,setTimeout(()=>{U=!1},Q)}}var f={value:(q)=>q.target.value,checked:(q)=>q.target.checked,numberValue:(q)=>Number(q.target.value),files:(q)=>q.target.files,formData:(q)=>{return q.preventDefault(),new FormData(q.target)}};function g(q,Q,U,Y){let{event:Z,modifiers:$}=B(U),j=(F)=>{if(F.target.closest(Q))A(Y,$)(F)},V={capture:$.includes("capture"),passive:$.includes("passive")};return q.addEventListener(Z,j,V),()=>{q.removeEventListener(Z,j,V)}}function p(q,Q,U){let Y=Array.isArray(q)?q:[q];return(Z)=>{if(Y.includes(Z.key)){if(U?.preventDefault)Z.preventDefault();Q(Z)}}}var v={enter:"Enter",escape:"Escape",tab:"Tab",space:" ",arrowUp:"ArrowUp",arrowDown:"ArrowDown",arrowLeft:"ArrowLeft",arrowRight:"ArrowRight"};var G=new Map,O=new T,R=!1,J={},X=null,W=null,_=null;function o(q={}){if(R){console.warn("GoSPA runtime already initialized");return}if(J=q,R=!0,J.wsUrl)X=import("./websocket-w636jzy0.js").then((Q)=>{return Q.initWebSocket({url:J.wsUrl,onMessage:n}).connect().catch((Y)=>{if(J.onConnectionError)J.onConnectionError(Y);else if(J.debug)console.error("WebSocket connection failed:",Y)}),Q});window.addEventListener("error",(Q)=>{if(J.debug)console.error("Runtime error:",Q.error)}),window.__GOSPA__={config:J,components:G,globalState:O,init:o,createComponent:b,destroyComponent:qq,getComponent:Qq,getState:k,setState:Uq,callAction:I,bind:H,autoInit:K}}function n(q){switch(q.type){case"init":if(q.componentId&&q.data){let Q=G.get(q.componentId);if(Q)Q.states.fromJSON(q.data)}else if(q.state){let Q=q.state;for(let[U,Y]of Object.entries(Q)){let Z=U.indexOf(".");if(Z>0){let $=U.substring(0,Z),j=U.substring(Z+1),V=G.get($);if(V)V.states.set(j,Y)}else{for(let $ of G.values())if($.states.get(U)!==void 0)$.states.set(U,Y);O.set(U,Y)}}}break;case"update":if(q.componentId&&q.diff){let Q=G.get(q.componentId);if(Q)Q.states.fromJSON(q.diff)}break;case"sync":if(q.data)O.fromJSON(q.data);break;case"error":if(J.debug)console.error("Server error:",q.error);break}}var M="gospa_local_";function t(q){try{let Q=localStorage.getItem(M+q);return Q?JSON.parse(Q):null}catch{return null}}function e(q,Q){try{localStorage.setItem(M+q,JSON.stringify(Q))}catch{}}function b(q,Q,U=!1){let Y={id:q.id,definition:q,states:new T,derived:new Map,unsubscribers:[],cleanup:[],element:Q||null,isLocal:U};if(U){let Z=t(q.id);if(Z)for(let[$,j]of Object.entries(Z))Y.states.set($,j)}for(let[Z,$]of Object.entries(q.state))if(!U||Y.states.get(Z)===void 0)Y.states.set(Z,$);if(U)for(let Z of Object.keys(q.state)){let $=Y.states.get(Z);if($){let j=D($,()=>{e(q.id,Y.states.toJSON())});Y.unsubscribers.push(j)}}if(q.computed)for(let[Z,$]of Object.entries(q.computed))Y.derived.set(Z,new E($));if(q.watch)for(let[Z,$]of Object.entries(q.watch)){let j=Y.states.get(Z);if(j)Y.unsubscribers.push(D(j,$))}if(q.mount){let Z=q.mount();if(Z)Y.cleanup.push(Z)}return G.set(q.id,Y),Y}function qq(q){let Q=G.get(q);if(!Q)return;if(Q.definition.destroy)Q.definition.destroy();for(let U of Q.cleanup)U();for(let U of Q.unsubscribers)U();for(let U of Q.derived.values())U.dispose();G.delete(q)}function Qq(q){return G.get(q)}function k(q,Q){return G.get(q)?.states.get(Q)}async function Uq(q,Q,U){let Y=G.get(q);if(!Y)return;if(Y.states.set(Q,U),!Y.isLocal&&X){let $=(await X).getWebSocketClient();if($?.isConnected)$.send({type:"update",componentId:q,payload:{key:Q,value:U}})}}function I(q,Q,...U){let Y=G.get(q);if(!Y?.definition.actions?.[Q])throw Error(`Action "${Q}" not found on component "${q}"`);return Y.definition.actions[Q](...U)}function H(q,Q,U,Y,Z){let $=k(q,Y);if(!$)return console.warn(`State "${Y}" not found on component "${q}"`),()=>{};if(Z?.twoWay)return w(Q,$);return L(Q,$,{type:U,transform:Z?.transform})}function K(){let q=document.querySelectorAll("[data-gospa-component]");for(let Q of q){let U=Q.getAttribute("data-gospa-component"),Y=Q.getAttribute("data-gospa-state"),Z=Q.hasAttribute("data-gospa-local");if(!U)continue;let $={};try{$=Y?JSON.parse(Y):{}}catch{}let j=Q.getAttribute("data-gospa-hydrate")||J.hydration?.mode||"immediate",V=()=>{b({id:U,name:U,state:$},Q,Z),Yq(Q)};if(j==="visible"){let F=new IntersectionObserver((N)=>{if(N[0].isIntersecting)F.disconnect(),V()});F.observe(Q)}else if(j==="idle"&&"requestIdleCallback"in window)window.requestIdleCallback(()=>V(),{timeout:J.hydration?.timeout||2000});else V()}}function Yq(q=document){for(let Q of q.querySelectorAll("[data-bind]")){let U=Q.closest("[data-gospa-component]")?.getAttribute("data-gospa-component")||"",Y=Q.getAttribute("data-bind"),Z=Q.getAttribute("data-transform");if(!Y)continue;let[$,j="text"]=Y.split(":").map((F)=>F.trim()),V;if(Z&&typeof window[Z]==="function")V=window[Z];H(U,Q,j,$,{transform:V})}for(let Q of q.querySelectorAll("[data-on]")){let U=Q.closest("[data-gospa-component]")?.getAttribute("data-gospa-component")||"",Y=Q.getAttribute("data-on");if(!Y)continue;let[Z,$,j]=Y.split(":").map((F)=>F.trim()),V=j?j.split(",").map((F)=>F.trim()):[];C(Q,Z,async()=>{try{I(U,$,...V)}catch{if(X){let N=(await X).getWebSocketClient();if(N?.isConnected)N.sendAction($)}}})}for(let Q of q.querySelectorAll("[data-model]")){let U=Q.closest("[data-gospa-component]")?.getAttribute("data-gospa-component")||"",Y=Q.getAttribute("data-model");if(Y)H(U,Q,"value",Y,{twoWay:!0})}}async function Jq(){if(!X)X=import("./websocket-w636jzy0.js");return X}async function Xq(){if(!W)W=import("./navigation-jzeg1fz2.js");return W}async function Nq(){if(!_)_=import("./transition-xkm7bqsm.js");return _}if(typeof document<"u"){if(document.readyState==="loading")document.addEventListener("DOMContentLoaded",()=>{if(document.documentElement.hasAttribute("data-gospa-auto"))K()});else if(document.documentElement.hasAttribute("data-gospa-auto"))K()}export{D as watch,r as unregisterBinding,f as transformers,u as throttle,Uq as setState,a as renderList,s as renderIf,d as registerBinding,p as onKey,C as on,S as offAll,v as keys,o as init,Jq as getWebSocket,Nq as getTransitions,k as getState,Xq as getNavigation,Qq as getComponent,i as effect,qq as destroyComponent,g as delegate,y as debounce,b as createComponent,I as callAction,w as bindTwoWay,L as bindElement,H as bind,c as batch,K as autoInit,T as StateMap,l as Rune,m as Effect,E as Derived};
export{C as a,S as b,y as c,u as d,f as e,g as f,p as g,v as h,o as i,b as j,qq as k,Qq as l,k as m,Uq as n,I as o,H as p,K as q,Jq as r,Xq as s,Nq as t};
